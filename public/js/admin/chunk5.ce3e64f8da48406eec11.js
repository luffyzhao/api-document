webpackJsonp([5],{401:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=a(402),i=a.n(o),n=a(405),s=a.n(n),l=a(408),r=a.n(l);e.default={data(){this.$createElement;return{Columns:[{title:"权限组",key:"name"},{title:"权限组名称",key:"display_name"},{title:"权限组描述",key:"description"},{title:"操作",render:(t,{row:e,column:a,index:o})=>t("button-group",null,[t("i-button",{on:{click:()=>{this.updateButton(e)}},attrs:{size:"small"}},["更新"]),t("i-button",{on:{click:()=>{this.allotButton(e)}},attrs:{size:"small"}},["分配"]),t("poptip",{attrs:{transfer:!0,title:"您确认删除这条内容吗？",confirm:!0},on:{"on-ok":()=>{this.deleteButton(e)}}},[t("i-button",{attrs:{size:"small"}},["删除"])])])}],Datas:[],page:{total:40,current:1,page_size:20},createModalShow:!1,updateModalShow:!1,allotModalShow:!1,allotId:0,updateId:0}},mounted(){this.search(1)},methods:{search(t){this.$get("admin/role",{page:t}).then(t=>{this.Datas=t.data.data,this.page.total=t.data.total,this.page.current=t.data.current_page,this.page.page_size=t.data.per_page})},updateButton(t){this.updateId=t.id,this.updateModalShow=!0},allotButton(t){this.allotId=t.id,this.allotModalShow=!0},deleteButton(t){this.$delete(`admin/role/${t.id}`).then(t=>{this.$Message.error("权限组删除成功!"),this.search(this.page.current)})},visibleChangeCreate(t){this.createModalShow=t,!1===t&&this.search(1)},visibleChangeAllot(t){this.allotModalShow=t},visibleChangeUpdate(t){this.updateModalShow=t,!1===t&&this.search(this.page.current)}},components:{Create:i.a,Update:s.a,Allot:r.a}}},402:function(t,e,a){var o=a(4)(a(403),a(404),!1,null,null,null);t.exports=o.exports},403:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default={props:{show:{type:Boolean,default:!1}},computed:{modalShow:{get:function(){return this.show},set:function(){}}},data:function(){return{loadingVisible:!1,formItem:{}}},methods:{visibleChange:function(t){!1===t?this.$emit("visibleChange",t):this.formItem={}},submit:function(t){var e=this;this.loadingVisible=!0,this.$refs[t].validate(function(t){t&&e.$post("admin/role",e.formItem).then(function(t){e.loadingVisible=!1,e.visibleChange(!1),e.$Message.error("权限组添加成功!")})})}}}},404:function(t,e){t.exports={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("Modal",{attrs:{title:"创建权限组","mask-closable":!1,"class-name":"vertical-center-modal",width:"auto","ok-text":"提交"},on:{"on-visible-change":t.visibleChange,"on-ok":t.submit},model:{value:t.modalShow,callback:function(e){t.modalShow=e},expression:"modalShow"}},[a("Form",{ref:"formItem",attrs:{model:t.formItem,"label-width":100}},[a("FormItem",{attrs:{label:"权限组",prop:"name",rules:{required:!0,message:"权限组验证不通过!",trigger:"blur",pattern:/^[a-z0-9_]+$/i}}},[a("Input",{staticStyle:{width:"500px"},attrs:{placeholder:"Enter something..."},model:{value:t.formItem.name,callback:function(e){t.$set(t.formItem,"name",e)},expression:"formItem.name"}})],1),t._v(" "),a("FormItem",{attrs:{label:"权限组名称",prop:"display_name",rules:{required:!0,message:"权限组名称验证不通过!",trigger:"blur"}}},[a("Input",{staticStyle:{width:"500px"},attrs:{placeholder:"Enter something..."},model:{value:t.formItem.display_name,callback:function(e){t.$set(t.formItem,"display_name",e)},expression:"formItem.display_name"}})],1),t._v(" "),a("FormItem",{attrs:{label:"权限组描述",prop:"description"}},[a("Input",{staticStyle:{width:"500px"},attrs:{type:"textarea",placeholder:"Enter something..."},model:{value:t.formItem.description,callback:function(e){t.$set(t.formItem,"description",e)},expression:"formItem.description"}})],1)],1),t._v(" "),a("div",{attrs:{slot:"footer"},slot:"footer"},[a("Button",{attrs:{type:"primary",size:"large",loading:t.loadingVisible},on:{click:function(e){t.submit("formItem")}}},[t._v("提交")])],1)],1)],1)},staticRenderFns:[]}},405:function(t,e,a){var o=a(4)(a(406),a(407),!1,null,null,null);t.exports=o.exports},406:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default={props:{show:{type:Boolean,default:!1},row:{type:Number,default:0}},computed:{modalShow:{get:function(){return this.show},set:function(){}},updateId:function(){return this.row}},data:function(){return{loadingVisible:!1,formItem:{}}},methods:{visibleChange:function(t){!1===t&&this.$emit("visibleChange",t)},submit:function(t){var e=this;this.loadingVisible=!0,this.$refs[t].validate(function(t){t&&e.$put("admin/role/"+e.updateId,{name:e.formItem.name,display_name:e.formItem.display_name,description:e.formItem.description}).then(function(t){e.visibleChange(!1),e.$Message.error("权限组更新成功!")})}),this.loadingVisible=!1}},watch:{modalShow:function(t,e){var a=this;t&&this.$get("admin/role/"+this.updateId).then(function(t){a.formItem=t.data})}}}},407:function(t,e){t.exports={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("Modal",{attrs:{title:"修改权限组","mask-closable":!1,"class-name":"vertical-center-modal",width:"auto","ok-text":"提交"},on:{"on-visible-change":t.visibleChange,"on-ok":t.submit},model:{value:t.modalShow,callback:function(e){t.modalShow=e},expression:"modalShow"}},[a("Form",{ref:"formItem",attrs:{model:t.formItem,"label-width":100}},[a("FormItem",{attrs:{label:"权限组",prop:"name",rules:{required:!0,message:"权限组验证不通过!",trigger:"blur",pattern:/^[a-z0-9_]+$/i}}},[a("Input",{staticStyle:{width:"500px"},attrs:{placeholder:"Enter something..."},model:{value:t.formItem.name,callback:function(e){t.$set(t.formItem,"name",e)},expression:"formItem.name"}})],1),t._v(" "),a("FormItem",{attrs:{label:"权限组名称",prop:"display_name",rules:{required:!0,message:"权限组名称验证不通过!",trigger:"blur"}}},[a("Input",{staticStyle:{width:"500px"},attrs:{placeholder:"Enter something..."},model:{value:t.formItem.display_name,callback:function(e){t.$set(t.formItem,"display_name",e)},expression:"formItem.display_name"}})],1),t._v(" "),a("FormItem",{attrs:{label:"权限组描述",prop:"description"}},[a("Input",{staticStyle:{width:"500px"},attrs:{type:"textarea",placeholder:"Enter something..."},model:{value:t.formItem.description,callback:function(e){t.$set(t.formItem,"description",e)},expression:"formItem.description"}})],1)],1),t._v(" "),a("div",{attrs:{slot:"footer"},slot:"footer"},[a("Button",{attrs:{type:"primary",size:"large",loading:t.loadingVisible},on:{click:function(e){t.submit("formItem")}}},[t._v("提交")])],1)],1)],1)},staticRenderFns:[]}},408:function(t,e,a){var o=a(4)(a(409),a(410),!1,null,null,null);t.exports=o.exports},409:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default={props:{show:{type:Boolean,default:!1},row:{type:Number,default:0}},computed:{modalShow:{get:function(){return this.show},set:function(){}},allotId:function(){return this.row}},data:function(){return{loadingVisible:!1,formItem:{permission:[],data:[]}}},methods:{visibleChange:function(t){!1===t&&this.$emit("visibleChange",t)},allCheck:function(){this.formItem.data.length===this.formItem.permission.length?this.formItem.data=[]:this.formItem.data=this.formItem.permission.map(function(t){return t.id})},submit:function(t){var e=this;this.loadingVisible=!0,this.$post("admin/role/"+this.allotId+"/permission",{relation:this.formItem.data}).then(function(t){e.loadingVisible=!1,e.visibleChange(!1)})}},watch:{modalShow:function(t,e){var a=this;t?(this.$get("admin/permission/all").then(function(t){a.formItem.permission=t.data}),this.$get("admin/role/"+this.allotId+"/permission").then(function(t){a.formItem.data=t.data.map(function(t){return t.id})})):this.formItem.data=[]}}}},410:function(t,e){t.exports={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("Modal",{attrs:{title:"分配权限","mask-closable":!1,"class-name":"vertical-center-modal",width:"500","ok-text":"提交"},on:{"on-visible-change":t.visibleChange,"on-ok":t.submit},model:{value:t.modalShow,callback:function(e){t.modalShow=e},expression:"modalShow"}},[a("Form",{ref:"formItem",attrs:{model:t.formItem,"label-width":1}},[a("FormItem",[a("CheckboxGroup",{model:{value:t.formItem.data,callback:function(e){t.$set(t.formItem,"data",e)},expression:"formItem.data"}},t._l(t.formItem.permission,function(e){return a("Checkbox",{key:e.id,attrs:{label:e.id}},[t._v(t._s(e.display_name))])}))],1)],1),t._v(" "),a("div",{attrs:{slot:"footer"},slot:"footer"},[a("Button",{attrs:{size:"large"},on:{click:t.allCheck}},[t._v("全选")]),t._v(" "),a("Button",{attrs:{type:"primary",size:"large",loading:t.loadingVisible},on:{click:function(e){t.submit("formItem")}}},[t._v("提交")])],1)],1)],1)},staticRenderFns:[]}},411:function(t,e){t.exports={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"box-flex"},[a("div",{staticClass:"box-flex-list"},[a("Card",{attrs:{bordered:!1}},[a("p",{attrs:{slot:"title"},slot:"title"},[a("span",[t._v("列表")]),t._v(" "),a("Button",{attrs:{size:"small",type:"success"},on:{click:function(e){t.createModalShow=!0}}},[t._v("添加")])],1),t._v(" "),a("Table",{ref:"table",attrs:{columns:t.Columns,data:t.Datas,size:"small"}}),t._v(" "),a("Page",{attrs:{total:t.page.total,size:"small",current:t.page.current,"page-size":t.page.page_size,"show-total":""},on:{"update:current":function(e){t.$set(t.page,"current",e)}}})],1)],1),t._v(" "),a("Create",{attrs:{show:t.createModalShow},on:{visibleChange:t.visibleChangeCreate}}),t._v(" "),a("Update",{attrs:{show:t.updateModalShow,row:t.updateId},on:{visibleChange:t.visibleChangeUpdate}}),t._v(" "),a("Allot",{attrs:{show:t.allotModalShow,row:t.allotId},on:{visibleChange:t.visibleChangeAllot}})],1)},staticRenderFns:[]}},476:function(t,e,a){var o=a(4)(a(401),a(411),!1,null,null,null);t.exports=o.exports}});